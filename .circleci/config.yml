version: 2.1

orbs:
  slack: circleci/slack@4.4.4

parameters:
  terraform_apply:
    type: boolean
    default: true
  terraform_destroy:
    type: boolean
    default: false

jobs:
  slack_notify:
    machine:
      image: ubuntu-1604:202007-01
    steps:
      - slack/notify:
          message: 'Start to Create or Update the EKS cluster via terraform by $CIRCLE_USERNAME'
          channel: circleci-notification
          color: '#FF00FF'
          url: 'https://circleci.com/workflow-run/${CIRCLE_WORKFLOW_ID}'

workflows:
  terraform_create_eks_cluster:
    when: << pipeline.parameters.terraform_apply >>
    jobs:
      - slack_notify